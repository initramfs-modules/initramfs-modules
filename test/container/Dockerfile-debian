FROM docker.io/debian:sid

RUN apt-get update -y -qq && apt-get upgrade -y -qq

# kernel
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y -qq --no-install-recommends -o Dpkg::Use-Pty=0 linux-image-generic

# dracut
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y -qq --no-install-recommends -o Dpkg::Use-Pty=0 dracut-live dracut-network

# common
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y -qq --no-install-recommends -o Dpkg::Use-Pty=0 \
    btrfs-progs cryptsetup dash dmraid mdadm sed lvm2 make sudo e2fsprogs

# common - but distro specific name
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y -qq --no-install-recommends -o Dpkg::Use-Pty=0 \
    openssh-client multipath-tools squashfs-tools qemu-system-x86

# networking
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y -qq --no-install-recommends -o Dpkg::Use-Pty=0 \
    iputils-arping iputils-ping isc-dhcp-client isc-dhcp-server nbd-client nbd-server nfs-kernel-server open-iscsi curl

RUN DEBIAN_FRONTEND=noninteractive apt-get install -y -qq --no-install-recommends -o Dpkg::Use-Pty=0 \
    binutils \
    busybox-static \
    bzip2 \
    ca-certificates \
    console-setup \
    fdisk \
    kmod \
    libdmraid-dev \
    less \
    libkmod-dev \
    ntfs-3g \
    parted \
    pigz \
    pkg-config \
    procps \
    tgt \
    thin-provisioning-tools \
    vim \
    sysvinit-core \
    zstd \
    && apt-get clean

RUN cp /usr/bin/dracut /usr/lib/dracut/dracut.sh
